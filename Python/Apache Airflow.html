
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.7">
    
    
      
        <title>Apache Airflow - Road to a data engineer</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.f1a3b89f.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font-family:"Ubuntu";--md-code-font-family:""}</style>
      
    
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="cyan">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apache-airflow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Road to a data engineer" class="md-header__button md-logo" aria-label="Road to a data engineer" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Road to a data engineer
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Apache Airflow
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Road to a data engineer" class="md-nav__button md-logo" aria-label="Road to a data engineer" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Road to a data engineer
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Current situation and learning path
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Data%20Engineer%20Landscape.html" class="md-nav__link">
        Data Engineering Landscape
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Databases
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Databases" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Databases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Databases/Data%20Warehouse%20Toolkit.html" class="md-nav__link">
        Data warehouse toolkit notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Databases/Database_design.html" class="md-nav__link">
        Database Design video course and notes
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Decision Journal
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Decision Journal" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Decision Journal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Decision%20Journal/01%20GCP%20decision.html" class="md-nav__link">
        Decision: Choice of cloud platform to learn
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Decision%20Journal/dj%20template.html" class="md-nav__link">
        Decision Journal Template
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Google Cloud Platform
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Google Cloud Platform" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Google Cloud Platform
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/GCP%20code%20snippets.html" class="md-nav__link">
        Common GCP code snippets
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      <label class="md-nav__link" for="__nav_5_2">
        Data Engineering Certificate
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data Engineering Certificate" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Data Engineering Certificate
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/de_certificate_misc_notes.html" class="md-nav__link">
        Data Engineering Certificate Misc Notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/de_certificate_practice_exam_notes.html" class="md-nav__link">
        Data Engineering practice Exam notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_ai_platform.html" class="md-nav__link">
        Google AI Platform
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_bigquery.html" class="md-nav__link">
        BigQuery
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_bigtable.html" class="md-nav__link">
        Google Cloud Bigtable
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_cloud_sql.html" class="md-nav__link">
        Cloud SQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_dataflow.html" class="md-nav__link">
        Google Dataflow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_datalab.html" class="md-nav__link">
        Google Datalab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_dataproc.html" class="md-nav__link">
        Google Dataproc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_datastore_and_firestore.html" class="md-nav__link">
        Google Datastore and Firestore
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_memorystore.html" class="md-nav__link">
        Google Memorystore
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_pubsub.html" class="md-nav__link">
        Google Pub/Sub
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_spanner.html" class="md-nav__link">
        Google Cloud Spanner
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_storage.html" class="md-nav__link">
        Google Storage
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/Data%20Engineering%20Certificate/google_tensorflow.html" class="md-nav__link">
        Google Tensorflow
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      <label class="md-nav__link" for="__nav_5_3">
        Qwiklabs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Qwiklabs" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Qwiklabs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/qwiklabs/01_Quest%20badges.html" class="md-nav__link">
        Badges earned on Qwiklabs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/qwiklabs/Baseline%20Data%20ML%20AI%20quest.html" class="md-nav__link">
        Baseline Data ML AI Quest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/qwiklabs/Baseline%20Infrasctructure.html" class="md-nav__link">
        Baseline Infrastructure Quest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/qwiklabs/BigQuery%20for%20Data%20Analysts.html" class="md-nav__link">
        BigQuery for data analysts quest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/qwiklabs/BigQuery%20for%20Marketing.html" class="md-nav__link">
        BigQuery for Marketing Analysts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/qwiklabs/BigQuery%20for%20data%20analysis.html" class="md-nav__link">
        BigQuery for Data Analysis Quest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/qwiklabs/BigQuery%20for%20data%20warehousing.html" class="md-nav__link">
        BigQuery for Data Warehousing Quest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/qwiklabs/Data_engineering_quest.html" class="md-nav__link">
        Data Engineering Quest
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Google%20Cloud%20Platform/qwiklabs/Machine%20learning%20APIs.html" class="md-nav__link">
        Integrate Machine Learning APIs Quest
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Jobs and Roles
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Jobs and Roles" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Jobs and Roles
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Jobs%20and%20Roles/data_engineer_role_sumathi_team.html" class="md-nav__link">
        Conversation with chapter lead data engineer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Jobs%20and%20Roles/junior_data_engineer_at_woolies01.html" class="md-nav__link">
        Junior data engineer at woolies01
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Linux
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      <label class="md-nav__link" for="__nav_7_1">
        Data Analytics at the terminal
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data Analytics at the terminal" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Data Analytics at the terminal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_1" type="checkbox" id="__nav_7_1_1" >
      
      <label class="md-nav__link" for="__nav_7_1_1">
        Crash Course
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Crash Course" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_1">
          <span class="md-nav__icon md-icon"></span>
          Crash Course
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/00_introduction.html" class="md-nav__link">
        Introduction and Motivation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/01_fundamental_bash_commands.html" class="md-nav__link">
        Fundamental Bash Commands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/02_expanding_the_fundamentals.html" class="md-nav__link">
        Expanding the fundamentals for Data Analysis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/03_downloading_files.html" class="md-nav__link">
        Downloading files with Bash
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/04_working_with_text_files.html" class="md-nav__link">
        Working with and manipulating text files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/05_common_text_file_cleaning.html" class="md-nav__link">
        BONUS - Common text file cleaning operations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/06_toolkit_setup.html" class="md-nav__link">
        Setup data tools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/07_csvkit_a_brief_detour.html" class="md-nav__link">
        csvkit - a brief introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/08_getting_data_into_sqlite.html" class="md-nav__link">
        08 getting data into sqlite
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/09_interacting_with_sqlite.html" class="md-nav__link">
        Interacting with SQLite databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/11_common_cleaning_tasks_in_sql.html" class="md-nav__link">
        Common data cleaning and transforming tasks in SQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/12_replicating_common_spreadsheet_tasks_in_sql.html" class="md-nav__link">
        Replicating common spreadsheet tasks in SQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/13_building_a_bash_script.html" class="md-nav__link">
        Building a pipeline as a bash script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Crash%20Course/50_addditional_resources.html" class="md-nav__link">
        Additional resources
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_2" type="checkbox" id="__nav_7_1_2" >
      
      <label class="md-nav__link" for="__nav_7_1_2">
        Deepnote Notebooks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Deepnote Notebooks" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_2">
          <span class="md-nav__icon md-icon"></span>
          Deepnote Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Deepnote%20Notebooks/00_intro_to_data_analytics_at_terminal.html" class="md-nav__link">
        Environment setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Deepnote%20Notebooks/01_poking_around.html" class="md-nav__link">
        Exploring terminal functionality for interacting with data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Deepnote%20Notebooks/02_grep_in_depth.html" class="md-nav__link">
        GREP basics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Deepnote%20Notebooks/05_becoming%20familiar%20with%20the%20data.html" class="md-nav__link">
        Getting a feel for the data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Deepnote%20Notebooks/06_saving_data_to_sqlite.html" class="md-nav__link">
        Saving data to SQLite at the terminal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/Data%20Analytics%20at%20the%20terminal/Deepnote%20Notebooks/utilities%20available.html" class="md-nav__link">
        CSV and SQLite tools overview
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Projects
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Projects" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Projects
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1" type="checkbox" id="__nav_8_1" >
      
      <label class="md-nav__link" for="__nav_8_1">
        Bitcoin Price Dashboard
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Bitcoin Price Dashboard" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_1">
          <span class="md-nav__icon md-icon"></span>
          Bitcoin Price Dashboard
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/Bitcoin%20Price%20Dashboard/01%20-%20summary.html" class="md-nav__link">
        Bitcoin Dashboard Project Details
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/Bitcoin%20Price%20Dashboard/02%20-%20Cloud%20Function%20Code.html" class="md-nav__link">
        Bitcoin dashboard Cloud Function code
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/Bitcoin%20Price%20Dashboard/03%20-%20Google%20Cloud%20Scheduler.html" class="md-nav__link">
        Scheduling and Monitoring
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/Bitcoin%20Price%20Dashboard/04%20-%20Raw%20data%20transformation.html" class="md-nav__link">
        Bitcoin Data Transformation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/Bitcoin%20Price%20Dashboard/05%20-%20Project%20Visualisation.html" class="md-nav__link">
        Bitcoin project visualisation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_2" type="checkbox" id="__nav_8_2" >
      
      <label class="md-nav__link" for="__nav_8_2">
        fivethirtyeight data to BigQuery
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="fivethirtyeight data to BigQuery" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_2">
          <span class="md-nav__icon md-icon"></span>
          fivethirtyeight data to BigQuery
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/fivethirtyeight%20data%20to%20BigQuery/01%20-%20summary.html" class="md-nav__link">
        Project details
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/fivethirtyeight%20data%20to%20BigQuery/02%20-%20airflow%20setup.html" class="md-nav__link">
        Airflow server setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/fivethirtyeight%20data%20to%20BigQuery/02b%20-%20DAG%20screenshots.html" class="md-nav__link">
        Airflow screenshots
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/fivethirtyeight%20data%20to%20BigQuery/03%20-%20The%20DAG.html" class="md-nav__link">
        fivethirtyeight DAG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Projects/fivethirtyeight%20data%20to%20BigQuery/04%20-%20Project%20Visualisations.html" class="md-nav__link">
        Project visualisations
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" checked>
      
      <label class="md-nav__link" for="__nav_9">
        Python
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Python" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Apache Airflow
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Apache%20Airflow.html" class="md-nav__link md-nav__link--active">
        Apache Airflow
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#podcast-episode-on-talk-python-to-me" class="md-nav__link">
    Podcast episode on Talk python to me
  </a>
  
    <nav class="md-nav" aria-label="Podcast episode on Talk python to me">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_2" type="checkbox" id="__nav_9_2" >
      
      <label class="md-nav__link" for="__nav_9_2">
        Data Engineering with python
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data Engineering with python" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_2">
          <span class="md-nav__icon md-icon"></span>
          Data Engineering with python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="Data%20Engineering%20with%20python/Chapter%201.html" class="md-nav__link">
        Chapter 1: What is data engineering
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Data%20Engineering%20with%20python/Chapter%202%20-%20Notebook.html" class="md-nav__link">
        Chapter 2 - Notebook
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Data%20Engineering%20with%20python/Chapter%202.html" class="md-nav__link">
        Chapter 2: Building Our Data Engineering Infrastructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Data%20Engineering%20with%20python/Chapter%203%20-%20Notebook.html" class="md-nav__link">
        Chapter 3   Notebook
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Data%20Engineering%20with%20python/Chapter%203.html" class="md-nav__link">
        Chapter 3: Reading and writing files
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Data%20Engineering%20with%20python/Chapter%204%20-%20Notebook2.html" class="md-nav__link">
        Chapter 4 - Notebook
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Data%20Engineering%20with%20python/Chapter%204.html" class="md-nav__link">
        Chapter 4: Working with Databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Data%20Engineering%20with%20python/misc.html" class="md-nav__link">
        Misc
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_3" type="checkbox" id="__nav_9_3" >
      
      <label class="md-nav__link" for="__nav_9_3">
        Google Colab
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Google Colab" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_3">
          <span class="md-nav__icon md-icon"></span>
          Google Colab
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="Google%20Colab/Converting_video_types_on_Google_Colab.html" class="md-nav__link">
        Converting between video types
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Google%20Colab/Domo_Card_backup.html" class="md-nav__link">
        Backup of Domo Cards
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_3_3" type="checkbox" id="__nav_9_3_3" >
      
      <label class="md-nav__link" for="__nav_9_3_3">
        Intro to Google Colab Notebooks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Intro to Google Colab Notebooks" data-md-level="3">
        <label class="md-nav__title" for="__nav_9_3_3">
          <span class="md-nav__icon md-icon"></span>
          Intro to Google Colab Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="Google%20Colab/Intro%20to%20Google%20Colab%20Notebooks/00_intro_to_colab.html" class="md-nav__link">
        What is Google Colab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Google%20Colab/Intro%20to%20Google%20Colab%20Notebooks/01_using_google_drive_as_a_filesystem.html" class="md-nav__link">
        Using Google Drive as a filesystem in Google Colab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Google%20Colab/Intro%20to%20Google%20Colab%20Notebooks/02_reading_and_saving_to_google_sheets.html" class="md-nav__link">
        Reading from and saving to Google Sheets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Google%20Colab/Intro%20to%20Google%20Colab%20Notebooks/03_pulling_data_from_Adobe_analytics.html" class="md-nav__link">
        Accessing Adobe Analytics data through the API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Google%20Colab/Intro%20to%20Google%20Colab%20Notebooks/04_querying_BigQuery.html" class="md-nav__link">
        Query BigQuery from within Google Colab
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_4" type="checkbox" id="__nav_9_4" >
      
      <label class="md-nav__link" for="__nav_9_4">
        Pycon US 2021
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pycon US 2021" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_4">
          <span class="md-nav__icon md-icon"></span>
          Pycon US 2021
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="Pycon%20US%202021/01%20keynote.html" class="md-nav__link">
        Keynote: Robert Erdmann
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Pycon%20US%202021/02%20creating%20extensible%20workflows.html" class="md-nav__link">
        Creating extensible workflows
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Pycon%20US%202021/03%20using%20papermill.html" class="md-nav__link">
        What we learned from Papermill to operationalize notebooks
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Pycon%20US%202021/04%20documentation%20for%20developers.html" class="md-nav__link">
        Writing Good Documentation for Developers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Pycon%20US%202021/07%20Google%20Serverless%20Application%20Architecture.html" class="md-nav__link">
        Google: Serverless Application Architecture
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="Pycon%20US%202021/08%20Build%20slack%20apps%20fast%20in%20python.html" class="md-nav__link">
        Build Slack apps fast in Python
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      <label class="md-nav__link" for="__nav_10">
        Resources
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Resources" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Resources/code_snippets.html" class="md-nav__link">
        Code snippets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Resources/data_engineering_through_osmosis.html" class="md-nav__link">
        Data Engineering through osmosis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Resources/links.html" class="md-nav__link">
        Links
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Resources/project_ideas.html" class="md-nav__link">
        Project ideas
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Resources/videos.html" class="md-nav__link">
        Videos
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#podcast-episode-on-talk-python-to-me" class="md-nav__link">
    Podcast episode on Talk python to me
  </a>
  
    <nav class="md-nav" aria-label="Podcast episode on Talk python to me">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="apache-airflow">Apache Airflow</h1>
<h2 id="podcast-episode-on-talk-python-to-me">Podcast episode on Talk python to me</h2>
<p><a href="https://talkpython.fm/episodes/show/330/apache-airflow-open-source-workflow-with-python">Podcast episode - Apache Airflow Open-Source Workflow with Python</a></p>
<p><audio controls>
  <source src="https://marquin-space-object-storage-01.sgp1.cdn.digitaloceanspaces.com/audio/podcasts/330-apache-airflow.mp3" type="audio/mpeg">
Your browser does not support the audio element.
</audio> </p>
<h3 id="notes">Notes</h3>
<p>Cron is unable to handle complexities in scheduling and dependencies.</p>
<p>Luigi was used, but relied heavily on XML.</p>
<p>Airflow is an orchestration tool. <a href="https://airflow.apache.org/">Airflow Website</a></p>
<p>Airflow doesn't perform tasks, it tells other services to perform tasks.</p>
<p>Having an workflow orchestration tool, allows for teams to collaborate on data pipelines.</p>
<p>The components of Airflow are as follows:</p>
<ul>
<li>Sensor - waiting to see is an object in S3</li>
<li>Transfer - moving something from A to B</li>
<li>Operator - anything in a service eg. starting a kubernetes cluster</li>
</ul>
<p>[link to Airflow operators or transfer or sensor]</p>
<p><a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/index.html">Airflow operators</a></p>
<p><a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/sensors/index.html">Airflow sensors</a></p>
<p>What is something goes wrong? Each task within Airflow should be idempotent. If run multiple times should produce the same result. Within Airflow there is the option to set the number of retries (eg 4).</p>
<p>There are on failure callbacks. sending email on failure letting you know.</p>
<p><img alt="airflow principles" src="https://marquin-space-object-storage-01.sgp1.cdn.digitaloceanspaces.com/web-resources/airflow_principles.png" /></p>
<p>A certain number of base operators come when airflow in pip installed.</p>
<p>Other integrations eg google big query are pip installable - seperate from the base installation.</p>
<p>It is possible to build your own providers.</p>
<p>What if I want airflow?</p>
<p>Hosted solutions:</p>
<ul>
<li>Google Cloud Composer</li>
</ul>
<iframe width="424" height="238" src="https://www.youtube.com/embed/pSjD5nHkXLU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<ul>
<li><a href="https://www.astronomer.io/">Astronomer</a></li>
</ul>
<iframe width="424" height="238" src="https://www.youtube.com/embed/dXKwIcua7MM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<ul>
<li>AWS <a href="https://docs.aws.amazon.com/mwaa/latest/userguide/what-is-mwaa.html">MWAA</a> (Managed Workflows for Apache Airflow) - </li>
</ul>
<p>There is a docker image for airflow. Docker compose is the quickstart.</p>
<p>Helm chart is recommended for production Airflow: <a href="https://airflow.apache.org/docs/helm-chart/stable/index.html">link</a></p>
<p>Airflow community summit: <a href="https://airflowsummit.org/">link</a></p>
<iframe width="1280" height="720" src="https://www.youtube.com/embed/pXSwJEkqAaQ?list=PLGudixcDaxY1noceCfAKU-kfpYIOgbC84" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Apache ::: Value community over code.</p>
<p>If the community is not healthy the code will not do well or last.</p>
<p>In Airflow 2.0 there is significant improvement to the dashboard UI.</p>
<p><a href="https://www.youtube.com/channel/UCSXwxpWZQ7XZ1WL3wqevChA">Apache Airflow YouTube channel</a></p>
<p>Everything is python in Airflow. It is not possible to edit the DAGs using the user interface.</p>
<p><strong>Example DAG</strong></p>
<pre><code class="language-python">
import json
from datetime import timedelta, datetime

from airflow import DAG
from airflow.operators.bash import BashOperator
from airflow.contrib.operators.bigquery_operator import BigQueryOperator
from airflow.operators.python import PythonVirtualenvOperator, PythonOperator

import os
import pathlib
import urllib.request
import zipfile
import shutil

default_args = {
    'owner': 'airflow',
    'depends_on_past': False,    
    'start_date': datetime(2021, 7, 14),
    'end_date': datetime(2021, 12, 5),
    'email': ['airflow@airflow.com'],
    'email_on_failure': True,
    'email_on_retry': False,
    'retries': 2,
    'retry_delay': timedelta(minutes=5),
}

#schedule_interval = &quot;00 05 * * *&quot;

BQ_CONN_ID = &quot;my_gcp_conn&quot;

dag = DAG(
    'dag_for_testing', 
    default_args=default_args)#, 
    #schedule_interval=schedule_interval
    #)

# -------------------- Python Functions -------------------- #

def where_am_i():
    &quot;&quot;&quot;Print the current working directory
    &quot;&quot;&quot;

    print(os.getcwd())

    return None

def download_repo():
    &quot;&quot;&quot;Download the fivethirtyeight data repo as a zip file.
    Saves the zip file in a folder called data
    &quot;&quot;&quot;

    pathlib.Path(os.getcwd(), &quot;data&quot;).mkdir(parents=True, exist_ok=True)

    url = &quot;https://github.com/fivethirtyeight/data/archive/refs/heads/master.zip&quot;

    urllib.request.urlretrieve(url, pathlib.Path(os.getcwd(), &quot;data&quot;, &quot;master.zip&quot;))

    print(url)

    return None

def unzip_repo():
    &quot;&quot;&quot;Unzips a file called master.zip that is saved in 
    a data folder.

    &quot;&quot;&quot;

    zip_path = pathlib.Path(os.getcwd(), &quot;data&quot;, &quot;master.zip&quot;)

    with zipfile.ZipFile(zip_path, 'r') as zip_ref:
        zip_ref.extractall(pathlib.Path(os.getcwd(), &quot;data&quot;))

    return None

def upload_dataframe_into_bq(pathlib_path_to_csv):
    &quot;&quot;&quot;With a file path to a csv file loads the csv file
    into a table in BigQuery. It uses the filename of the 
    csv file as the table name.

    Args:
        pathlib_path_to_csv (pathlib Path): [description]
    &quot;&quot;&quot;


    my_project = 'marquin-personal-tools'
    my_dataset = 'fivethirthyeight_staging'
    my_table = pathlib_path_to_csv.stem


    # upload to BigQuery
    client = bigquery.Client(project=my_project)

    table_name = pathlib_path_to_csv.stem

    table_ref = client.dataset(my_dataset).table(table_name)


    # set job load configuration settings

    job_config = bigquery.LoadJobConfig()
    job_config.source_format = bigquery.SourceFormat.CSV
    job_config.skip_leading_rows = 1 # ignore the header
    job_config.autodetect = True

    # delete the table if already exists
    table_id = my_project + '.' + my_dataset + '.' + my_table
    ic(table_id)
    client.delete_table(table_id, not_found_ok=True)

    # load the csv file into BQ table
    with open(pathlib_path_to_csv, &quot;rb&quot;) as source_file:
        job = client.load_table_from_file(
            source_file, table_ref, job_config=job_config
        )

    # job is async operation so we have to wait for it to finish
    job.result()

    return None


def load_csvs():

    from google.cloud import bigquery
    from icecream import ic
    import os
    import pathlib
    # This is to get the directory that the program 
    # is currently running in.
    #dir_path = os.path.dirname(os.path.realpath(__file__))
    #dir_path = os.path.join(dir_path, &quot;data&quot;)

    # directory for testing
    #dir_path = &quot;/home/fuzzy/Documents/Projects/fivethirtyeight_to_BQ/test_data&quot;

    i = 0

    for root, dirs, files in os.walk(pathlib.Path(os.getcwd(), &quot;data&quot;)):
        for file in files: 
            if i &gt; 10:
                return None

            # change the extension from '.mp3' to 
            # the one of your choice.
            if file.endswith('.csv'):
                #ic(root)
                #ic(dirs)
                #ic(file)
                temp_filepath = pathlib.Path(root, file)
                ic(temp_filepath)

                #temp_filepath.stem
                try:
                    upload_dataframe_into_bq(temp_filepath)
                    i = i + 1
                except:
                    print(&quot;#&quot;*8)
                    print(&quot;#&quot;*8)
                    print(&quot;Failed to load the following file to BQ:&quot;)
                    ic(temp_filepath)
                    print(&quot;#&quot;*8)
                    print(&quot;#&quot;*8)

    return None


def clean_directory():
    &quot;&quot;&quot;Deletes the data directory and its contents.
    &quot;&quot;&quot;

    directory_to_remove = pathlib.Path(os.getcwd(), &quot;data&quot;)
    shutil.rmtree(directory_to_remove)

    return None


# -------------------- Construct DAGs -------------------- #

t1 = PythonOperator(
    task_id='print_location',
    python_callable=where_am_i,
    dag=dag
)

t2 = PythonOperator(
    task_id='get_the_data',
    python_callable=download_repo,
    dag=dag
)

t3 = PythonOperator(
    task_id='unzip_the_data',
    python_callable=unzip_repo,
    dag=dag
)

t4 = BigQueryOperator(
        task_id='bq_create_prod_version_of_drink',    
        sql='''
        #standardSQL
        SELECT *,  
        RANK() OVER (
                ORDER BY beer_servings desc
            ) AS beer_rank,
        RANK() OVER (
                ORDER BY spirit_servings desc
            ) AS spirit_rank,
        RANK() OVER (
                ORDER BY wine_servings desc
            ) AS  wine_rank,
        beer_servings + spirit_servings + wine_servings as total_servings
        FROM `marquin-personal-tools.fivethirthyeight_staging.drinks` 
        ORDER BY country asc
        ''',
        destination_dataset_table='marquin-personal-tools.fivethirtyeight_prod.drinks_prod',    
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        bigquery_conn_id=BQ_CONN_ID,
        dag=dag
    )

t5 = PythonVirtualenvOperator(
    task_id='load_csvs_to_BQ',
    python_callable=load_csvs,
    requirements=[&quot;bigquery==0.0.15&quot;, &quot;icecream==2.1.1&quot;],
    dag=dag
)

t6 = PythonOperator(
    task_id='delete_downloaded_data',
    python_callable=clean_directory,
    dag=dag
)

# -------------------- Set up dependencies -------------------- #

t1 &gt;&gt; t2
t2 &gt;&gt; t3
t3 &gt;&gt; t5
t5 &gt;&gt; t4
t5 &gt;&gt; t6


</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../Projects/fivethirtyeight%20data%20to%20BigQuery/04%20-%20Project%20Visualisations.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Project visualisations" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Project visualisations
            </div>
          </div>
        </a>
      
      
        
        <a href="Data%20Engineering%20with%20python/Chapter%201.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 1: What is data engineering" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 1: What is data engineering
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.b0710199.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.76f349be.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
      
        <script src="../javascripts/config.js"></script>
      
    
  </body>
</html>